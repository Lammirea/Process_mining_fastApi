<!DOCTYPE html>
<html>
<head>
    {% block head %}
    <meta charset="utf-8"/>
    <link href="{{ url_for('static', path='/main_wnd.css') }}" rel="stylesheet">
    <!--<link rel="stylesheet" href="main_wnd.css" >-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{% endblock %} PmTool</title>
    {% endblock %}
</head>
<body>
    {% block page_content %}
<div class="menu">
    <h1 class="headerMenu">PmTool</h1>
    <div class="ProcessMining_menu">
        <h2 class="PD">Process Discovery</h2>
        <ul class="ProcessMining_list">
            <li>
                <a id="modelAlpha" class="AlphaMiner">Alpha Miner</a>
            </li>
            <li>
                <a id="modelInductive">Inductive Miner</a>
            </li>
            <li>
                <a id="modelHeuristic">Heuristic Miner</a>
            </li>
        </ul>
    </div>
    <div class="ConforChecking_menu">
        <h2 class="CH">Conformance Checking</h2>
        <ul class="ConforChecking_list">
            <li>Token-based replay</li>
        </ul>
    </div>
</div>
<div id="modalAlpha" class="show_modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <label class="input-file">
                <p class="ChooseLog">Выберите журнал событий</p>
                <input type="file" id="logRight" name="logRight" accept=".xes" onchange='openFile(event)'>
                <span class="input-file-btn">Выберите файл</span>
                <p class="ChooseChangedLog">Выберите изменённый журнал событий</p>
                <input type="file" id="LogChanged" name="LogChanged" accept=".xes" onchange='openFile(event)'>
                <span class="input-file-btn">Выберите файл</span>
            </label>         
        </div>
</div>
<div class="show_model">
    <div class="picture_of_model">
        {{model}} 
    </div>
    <button>Создать модель</button>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Get the modal
    var modal = document.getElementById("modalAlpha");
    
    // Get the button that opens the modal
    var btn = document.getElementById("modelAlpha");
    
    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];
    
    // When the user clicks the button, open the modal 
    btn.onclick = function() {
      modal.style.display = "block";
    }
    
    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = "none";
    }
    
    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }

    var openFile = function(event) {
    var input = event.target;

    var reader = new FileReader();
    reader.onload = function() {
        var text = reader.result;
        var node = document.getElementById('logRight');
        node.innerText = text;
        //console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);
    var data = reader.readAsText(input.files[0]);
    const s = JSON.stringify(reader); // Stringify converts a JavaScript object or value to a JSON string
    //window.alert(s)
    $.ajax({
            url:"/test",
            type:"POST",
            contentType: "application/json",
            data: JSON.stringify(s)});
};

    </script>
{% endblock %}
</body>
</html>